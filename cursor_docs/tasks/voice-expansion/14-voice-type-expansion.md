# 声の種類の拡張

## 概要
現在のユーザー設定では、限られた声の種類（ずんだもん、春日部つむぎ、波音リツなど）しか使用できません。VOICEVOXで利用可能な声の種類を増やし、ユーザーがより多くの選択肢から自分の好みの声を選べるようにします。

## 目標
- `src/commands/settings.ts`の`VOICES`配列に新しい声の種類を追加する
- カテゴリ別に声を整理して選びやすくする仕組みを検討する
- 現在のユーザー設定の仕組みを崩さないよう配慮する

## 実装ステップ
1. VOICEVOXで利用可能な声の種類を調査
2. `src/commands/settings.ts`の`VOICES`配列に新しい声の種類を追加
3. 声の種類が多くなるため、カテゴリ別に分類するか検討
4. 必要に応じてユーザーインターフェースを改善（オプション）
5. テストを実装・修正
6. ドキュメントを更新

## 注意点
- 既存ユーザーの設定に影響がないようにする
- スラッシュコマンドの選択肢が多すぎると使いにくくなる可能性がある
- VOICEVOXの各話者のライセンスを確認する必要がある

## 進捗
- [x] VOICEVOXで利用可能な声の種類を調査
- [x] `VOICES`配列に新しい声の種類を追加
- [x] 必要に応じてUIの改善策を検討
  - 選択肢が25個に制限されているため、二段階選択方式を実装
  - 話者（キャラクター）を先に選び、次にスタイルを選択する方式
- [x] テストの実装・修正
  - テストコードを新しいコマンド構造に合わせて更新
  - スピーカーとスタイルの選択に対応
- [x] インタラクションハンドラーの実装
  - スタイル選択メニューでの選択を処理するロジックを追加
  - `index.ts`の重複コードを`interactionHandler.ts`に移行・統合
- [ ] ドキュメントの更新

## 現在の課題
1. Discordのスラッシュコマンドには選択肢の数に制限があり、多くの声を追加するとエラーになる
   - エラー: `given: 33, expected: 'expected <= 25'`
   - 主要な25キャラクターのみを選択肢として表示する形で解決
   - 将来的にはグループ分けなどさらなる改善が必要かも

2. ~~テストの一部でエラーが残っている~~
   - ~~interactionHandlerのテストで2つのテストが失敗している~~
   - ~~shutdownHandlerのテストでもエラーが発生しているが、現実装には支障なし~~
   - テストの修正が完了

## 次のステップ
1. ドキュメント更新 - 設定変更方法について説明する
2. 将来的な改善点の検討 - カテゴリ別グループ分けなど

## まとめ
- VOICEVOX APIで利用可能な声の種類を大幅に増やすことができた
- Discordの制限（25選択肢まで）に対応するため、二段階選択方式を実装
- 話者と声質を分離して選べるようになり、より柔軟な声の選択が可能に
- インタラクションハンドラーを実装して、スタイル選択後の処理を追加 
- 既存の実装と新しい実装の機能を統合し、重複コードを削除
- テストコードを修正して、新しい実装に対応 